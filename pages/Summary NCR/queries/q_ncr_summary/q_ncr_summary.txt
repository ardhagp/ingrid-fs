SELECT DISTINCT COUNT(ncr_rowid) as `ncr_total`, (select DISTINCT COUNT(ncr_rowid) from mat_movement_ncr WHERE ncr_ncritemstatus='Open') as `ncr_open`, (select DISTINCT COUNT(ncr_rowid) from mat_movement_ncr WHERE ncr_ncritemstatus='Close') as `ncr_closed`, (SELECT ROUND(AVG(IF(ncr_ncritemclosedate <=> NULL, NULL, DATEDIFF(ncr_ncritemclosedate,mtx_datencr)))) FROM mat_movement_ncr INNER join mat_movement on mtx_id = ncr_mtxid WHERE ncr_ncritemstatus='Close' AND NOT (ncr_ncritemclosedate <=> NULL)) as `ncr_avg` FROM mat_movement_ncr;